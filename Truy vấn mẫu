SELECT
    N'1. THÔNG TIN NHÂN VIÊN VÀ CHỨC VỤ' AS 'KiemTra';
SELECT
    NV.MANHANVIEN,
    NV.HOVATEN AS N'Họ và Tên Nhân Viên',
    CV.TENCHUCVU AS N'Chức Vụ',
    BP.TENBOPHAN AS N'Bộ Phận'
FROM NHANVIEN NV
JOIN CHUCVU CV ON NV.MACHUCVU = CV.MACHUCVU
JOIN BOPHAN BP ON NV.MABOPHAN = BP.MABOPHAN;
GO

SELECT
    N'2. CHI TIẾT PHIẾU NHẬP VÀ GIÁ VỐN' AS 'KiemTra';
SELECT
    PN.MAPHIEUNHAP,
    PN.NGAYNHAP AS N'Ngày Nhập',
    NCC.TENNHACUNGCAP AS N'Nhà Cung Cấp',
    HH.TENHANGHOA AS N'Tên Hàng Hóa',
    CTPN.SOLUONGNHAP AS N'Số Lượng',
    CTPN.DONGIANHAP AS N'Đơn Giá Nhập',
    CTPN.SOLUONGNHAP * CTPN.DONGIANHAP AS N'Thành Tiền Nhập'
FROM PHIEUNHAP PN
JOIN NHACUNGCAP NCC ON PN.MANHACUNGCAP = NCC.MANHACUNGCAP
JOIN CHITIETPHIEUNHAP CTPN ON PN.MAPHIEUNHAP = CTPN.MAPHIEUNHAP
JOIN LOHANG LH ON CTPN.MALOHANG = LH.MALOHANG
JOIN HANGHOA HH ON LH.MAHANGHOA = HH.MAHANGHOA;
GO

SELECT
    N'3. THÔNG TIN KHÁCH HÀNG VIP' AS 'KiemTra';
SELECT
    KH.TENKHACHHANG AS N'Tên Khách Hàng',
    KH.SODIENTHOAI AS N'SĐT',
    KV.HANGVIP AS N'Hạng VIP',
    KV.DIEMTICHLUY AS N'Điểm Tích Lũy',
    KV.NGAYTHAMGIA AS N'Ngày Tham Gia VIP'
FROM KHACHHANG KH
JOIN KHACHHANG_VIP KV ON KH.MAKHACHHANG = KV.MAKHACHHANG;
GO

SELECT
    N'4. TỔNG HỢP HÓA ĐƠN VÀ SỐ LƯỢNG BÁN' AS 'KiemTra';
SELECT
    HD.MAHOADON,
    HD.NGAYLAPHOADON AS N'Ngày Lập HĐ',
    SUM(CTHD.SOLUONG) AS N'Tổng Số Lượng Bán Thực Tế',
    HD.TONGTIEN AS N'Tổng Tiền Hóa Đơn (Đã Lưu)'
FROM HOADON HD
JOIN CHITIETHOADON CTHD ON HD.MAHOADON = CTHD.MAHOADON
GROUP BY HD.MAHOADON, HD.NGAYLAPHOADON, HD.TONGTIEN;
GO

SELECT
    N'5. DANH SÁCH HÀNG HÓA CHƯA CÓ LÔ HÀNG' AS 'KiemTra';
SELECT
    HH.MAHANGHOA,
    HH.TENHANGHOA
FROM HANGHOA HH
LEFT JOIN LOHANG LH ON HH.MAHANGHOA = LH.MAHANGHOA
WHERE LH.MALOHANG IS NULL;
GO

SELECT
    N'6. THỐNG KÊ GIÁ TRỊ NHẬP THEO NHÀ CUNG CẤP' AS 'KiemTra';
SELECT
    NCC.TENNHACUNGCAP AS N'Nhà Cung Cấp',
    COUNT(PN.MAPHIEUNHAP) AS N'Tổng Số Phiếu Nhập',
    SUM(CTPN.SOLUONGNHAP * CTPN.DONGIANHAP) AS N'Tổng Giá Trị Nhập'
FROM NHACUNGCAP NCC
JOIN PHIEUNHAP PN ON NCC.MANHACUNGCAP = PN.MANHACUNGCAP
JOIN CHITIETPHIEUNHAP CTPN ON PN.MAPHIEUNHAP = CTPN.MAPHIEUNHAP
GROUP BY NCC.TENNHACUNGCAP
ORDER BY N'Tổng Giá Trị Nhập' DESC;
GO

SELECT
    N'7. KIỂM TRA PHIẾU CHI VÀ PHIẾU NHẬP ĐÃ THANH TOÁN' AS 'KiemTra';
SELECT
    PC.MAPHIEUCHI,
    PN.MAPHIEUNHAP,
    NCC.TENNHACUNGCAP AS N'Nhà Cung Cấp',
    PC.NGAYLAPPHIEU AS N'Ngày Chi',
    PN.NGAYNHAP AS N'Ngày Nhập Hàng'
FROM PHIEUCHI PC
JOIN PHIEUCHI_PHIEUNHAP PCPN ON PC.MAPHIEUCHI = PCPN.MAPHIEUCHI
JOIN PHIEUNHAP PN ON PCPN.MAPHIEUNHAP = PN.MAPHIEUNHAP
JOIN NHACUNGCAP NCC ON PC.MANHACUNGCAP = NCC.MANHACUNGCAP;
GO

SELECT
    N'8. CHI TIẾT HÓA ĐƠN BÁN HÀNG ĐẦY ĐỦ' AS 'KiemTra';
SELECT
    HD.MAHOADON,
    KH.TENKHACHHANG AS N'Khách Hàng',
    NV.HOVATEN AS N'Nhân Viên Bán Hàng',
    HH.TENHANGHOA AS N'Mặt Hàng',
    CTHD.SOLUONG AS N'SL Bán',
    HH.GIABAN AS N'Giá Bán',
    CTHD.THANHTIEN AS N'Thành Tiền'
FROM HOADON HD
JOIN KHACHHANG KH ON HD.MAKHACHHANG = KH.MAKHACHHANG
JOIN NHANVIEN NV ON HD.MANHANVIEN = NV.MANHANVIEN
JOIN CHITIETHOADON CTHD ON HD.MAHOADON = CTHD.MAHOADON
JOIN HANGHOA HH ON CTHD.MAHANGHOA = HH.MAHANGHOA
ORDER BY HD.MAHOADON;
GO

