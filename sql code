CREATE DATABASE QLCH

-- Bảng chức vụ
CREATE TABLE ChucVu (
    MaChucVu INT PRIMARY KEY,
    TenChucVu VARCHAR(20) 
);

-- Bảng Nhân viên
CREATE TABLE NhanVien (
    MaNhanVien INT PRIMARY KEY,
    MaChucVu INT,
    HoTen VARCHAR(100),
    GioiTinh VARCHAR(10),
    SoDienThoai VARCHAR(15) UNIQUE, 
    NgaySinh DATE NOT NULL,
    DiaChi VARCHAR(255),
    FOREIGN KEY (MaChucVu) REFERENCES ChucVu(MaChucVu)
);

-- Bảng Nhân viên FullTime
CREATE TABLE FullTime (
    MaNhanVien INT PRIMARY KEY,
    HopDongDaiHan VARCHAR(50) NOT NULL,
    LuongCoBan DECIMAL(15,2) NOT NULL,
    FOREIGN KEY (MaNhanVien) REFERENCES NhanVien(MaNhanVien)
);

-- Bảng Nhân viên PartTime
CREATE TABLE PartTime (
    MaNhanVien INT PRIMARY KEY,
    SoGioLam INT NOT NULL,
    LuongTheoGio DECIMAL(15,2) NOT NULL,
    FOREIGN KEY (MaNhanVien) REFERENCES NhanVien(MaNhanVien)
);

-- Bảng Lương
CREATE TABLE Luong (
    MaNhanVien INT PRIMARY KEY,
    ThoiGian INT NOT NULL,
    NghiKhongPhep INT DEFAULT 0,
    LuongThang13 DECIMAL(15,2),
    NgayBatDau DATE NOT NULL,
    FOREIGN KEY (MaNhanVien) REFERENCES NhanVien(MaNhanVien)
);

-- Bảng Khách hàng
CREATE TABLE KhachHang (
    MaKhachHang INT PRIMARY KEY,
    TenKhachHang VARCHAR(100) NOT NULL,
    SDT VARCHAR(15) UNIQUE,          -- có thể null nhưng nếu có thì không trùng
    GioiTinh VARCHAR(10),
    DiaChi VARCHAR(255)
);

-- Bảng Khách hàng VIP
CREATE TABLE KhachHangVIP (
    MaKhachHang INT PRIMARY KEY,
    DiemTichLuy INT NOT NULL,
    MucGiamGia DECIMAL(5,2) NOT NULL,
    FOREIGN KEY (MaKhachHang) REFERENCES KhachHang(MaKhachHang)
);

-- Bảng Khách hàng thành viên
CREATE TABLE KhachHangThanhVien (
    MaKhachHang INT PRIMARY KEY,
    NgayDangKy DATE NOT NULL,
    LoaiThe VARCHAR(20) NOT NULL,
    FOREIGN KEY (MaKhachHang) REFERENCES KhachHang(MaKhachHang)
);

-- Bảng Phản hồi
CREATE TABLE PhanHoi (
    MaPhanHoi INT PRIMARY KEY,
    MaKhachHang INT NOT NULL,
    DanhGiaSanPham VARCHAR(255) NOT NULL,
    DongGop VARCHAR(255),
    FOREIGN KEY (MaKhachHang) REFERENCES KhachHang(MaKhachHang)
);

-- Bảng Loại hàng
CREATE TABLE LoaiHang (
    MaLoaiHang INT PRIMARY KEY,
    TenLoaiHang VARCHAR(100) NOT NULL UNIQUE,
    MauMa VARCHAR(50),
    NoiSanXuat VARCHAR(100)
);

-- Bảng Hàng hóa
CREATE TABLE HangHoa (
    MaHH INT PRIMARY KEY,
    MaLoaiHang INT NOT NULL,
    TenHangHoa VARCHAR(100) NOT NULL,
    SoLuong INT NOT NULL,
    NgaySX DATE NOT NULL,
    HSD DATE NOT NULL,
    GiaBan DECIMAL(15,2) NOT NULL,
    FOREIGN KEY (MaLoaiHang) REFERENCES LoaiHang(MaLoaiHang)
);

-- Bảng Hóa đơn
CREATE TABLE HoaDon (
    MaHoaDon INT PRIMARY KEY,
    NgayLapHoaDon DATE NOT NULL,
    NgayNhanHang DATE,
    MaNhanVien INT NOT NULL,
    MaKhachHang INT NOT NULL,
    FOREIGN KEY (MaNhanVien) REFERENCES NhanVien(MaNhanVien),
    FOREIGN KEY (MaKhachHang) REFERENCES KhachHang(MaKhachHang)
);

-- Bảng Chi tiết hóa đơn (bảng trung gian N-N)
CREATE TABLE ChiTietHoaDon (
    MaHoaDon INT,
    MaHH INT,
    SoLuong INT NOT NULL,
    PRIMARY KEY (MaHoaDon, MaHH),
    FOREIGN KEY (MaHoaDon) REFERENCES HoaDon(MaHoaDon),
    FOREIGN KEY (MaHH) REFERENCES HangHoa(MaHH)
);
